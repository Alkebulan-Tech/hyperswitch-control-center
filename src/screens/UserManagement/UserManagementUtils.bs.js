// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Icon from "../../components/Icon.bs.js";
import * as React from "react";
import * as Core__JSON from "@rescript/core/src/Core__JSON.bs.js";
import * as LogicUtils from "../../utils/LogicUtils.bs.js";
import * as InputFields from "../../components/InputFields.bs.js";
import * as Core__Option from "@rescript/core/src/Core__Option.bs.js";
import * as FormRenderer from "../../components/form/FormRenderer.bs.js";
import * as HSwitchUtils from "../Utils/HSwitchUtils.bs.js";

var inviteEmail = FormRenderer.makeFieldInfo(
  "Enter email",
  undefined,
  "emailList",
  function (param) {
    return function (param$1) {
      var param$2 = "Press Enter to add more";
      var param$3;
      return InputFields.iconFieldWithMessageDes(
        function (input, param) {
          var showPlaceHolder =
            LogicUtils.getArrayFromJson(input.value, []).length === 0;
          return InputFields.textTagInput(
            input,
            showPlaceHolder
              ? "Eg: mehak.sam@wise.com, deepak.ven@wise.com"
              : "",
            undefined,
            undefined,
            undefined,
            true,
            undefined,
            "!rounded-full !px-4",
            undefined,
          );
        },
        param,
        param$1,
        param$2,
        param$3,
      );
    };
  },
  undefined,
  undefined,
  undefined,
  undefined,
  undefined,
  undefined,
  undefined,
  undefined,
  undefined,
  undefined,
  undefined,
  true,
  undefined,
  undefined,
  undefined,
);

var createCustomRole = FormRenderer.makeFieldInfo(
  "Enter custom role name",
  undefined,
  "role_name",
  function (param) {
    return function (param$1) {
      var param$2;
      var param$3;
      var param$4 = false;
      var param$5;
      var param$6;
      var param$7;
      var param$8 = "off";
      var param$9;
      var param$10;
      var param$11;
      var param$12;
      var param$13;
      var param$14;
      var param$15;
      var param$16;
      var param$17;
      var param$18;
      var param$19;
      var param$20;
      var param$21;
      var param$22;
      var param$23;
      var param$24;
      var param$25;
      var param$26;
      var param$27;
      return InputFields.textInput(
        param,
        param$1,
        param$2,
        param$3,
        param$4,
        param$5,
        param$6,
        param$7,
        param$8,
        param$9,
        param$10,
        param$11,
        param$12,
        param$13,
        param$14,
        param$15,
        param$16,
        param$17,
        param$18,
        param$19,
        param$20,
        param$21,
        param$22,
        param$23,
        param$24,
        param$25,
        param$26,
        param$27,
      );
    };
  },
  undefined,
  undefined,
  undefined,
  undefined,
  undefined,
  undefined,
  undefined,
  undefined,
  undefined,
  undefined,
  undefined,
  true,
  undefined,
  undefined,
  undefined,
);

function roleScope(userRole) {
  var roleScopeArray = ["Merchant", "Organization"].map(function (item) {
    return {
      label: item,
      value: item.toLowerCase(),
    };
  });
  var arg = userRole !== "org_admin";
  return FormRenderer.makeFieldInfo(
    "Role Scope ",
    undefined,
    "role_scope",
    function (param) {
      return function (param$1) {
        var param$2 = "Select Option";
        var param$3 = true;
        var param$4;
        var param$5;
        var param$6;
        var param$7;
        var param$8;
        var param$9;
        var param$10;
        var param$11;
        var param$12;
        var param$13;
        var param$14;
        var param$15;
        var param$16;
        var param$17;
        var param$18;
        var param$19;
        var param$20;
        var param$21;
        var param$22;
        var param$23;
        var param$24;
        var param$25;
        var param$26;
        var param$27;
        var param$28;
        var param$29;
        return InputFields.selectInput(
          param,
          roleScopeArray,
          param$1,
          param$2,
          param$3,
          param$4,
          arg,
          param$5,
          param$6,
          param$7,
          param$8,
          param$9,
          param$10,
          param$11,
          param$12,
          param$13,
          param$14,
          param$15,
          param$16,
          param$17,
          param$18,
          param$19,
          param$20,
          param$21,
          param$22,
          param$23,
          param$24,
          param$25,
          param$26,
          param$27,
          param$28,
          param$29,
        );
      };
    },
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    true,
    undefined,
    undefined,
    undefined,
  );
}

function validateEmptyValue(key, errors) {
  if (key === "emailList") {
    errors["email"] = "Please enter Invite mails";
    return;
  }
  errors[key] = "Please enter a " + LogicUtils.snakeToTitle(key) + "";
}

function validateForm(values, fieldsToValidate) {
  var errors = {};
  var valuesDict = LogicUtils.getDictFromJsonObject(values);
  fieldsToValidate.forEach(function (key) {
    var value = LogicUtils.getArrayFromDict(valuesDict, key, []);
    if (value.length === 0) {
      return validateEmptyValue(key, errors);
    } else {
      value.forEach(function (ele) {
        if (
          HSwitchUtils.isValidEmail(
            Core__Option.getOr(Core__JSON.Decode.string(ele), ""),
          )
        ) {
          errors["email"] = "Please enter a valid email";
          return;
        }
      });
      return;
    }
  });
  return errors;
}

function validateFormForRoles(values) {
  var errors = {};
  var valuesDict = LogicUtils.getDictFromJsonObject(values);
  if (
    LogicUtils.isEmptyString(LogicUtils.getString(valuesDict, "role_scope", ""))
  ) {
    errors["role_scope"] = "Role scope is required";
  }
  if (
    LogicUtils.isEmptyString(LogicUtils.getString(valuesDict, "role_name", ""))
  ) {
    errors["role_name"] = "Role name is required";
  }
  if (LogicUtils.getString(valuesDict, "role_name", "").length > 64) {
    errors["role_name"] = "Role name should be less than 64 characters";
  }
  if (LogicUtils.getArrayFromDict(valuesDict, "groups", []).length === 0) {
    errors["groups"] = "Roles required";
  }
  return errors;
}

function roleListDataMapper(ele) {
  var match = ele.role_name;
  var roleNameToDisplay =
    match === "iam"
      ? ele.role_name.toLocaleUpperCase()
      : LogicUtils.snakeToTitle(ele.role_name);
  return {
    label: roleNameToDisplay,
    value: ele.role_id,
  };
}

function roleOptions(roleListData) {
  return roleListData.map(roleListDataMapper);
}

function roleType(roleListData, boderColor) {
  var arg = roleListData.map(roleListDataMapper);
  var arg$1 = boderColor;
  return FormRenderer.makeFieldInfo(
    "Choose a role",
    undefined,
    "roleType",
    function (param) {
      return function (param$1) {
        var param$2;
        var param$3;
        var param$4;
        var param$5;
        var param$6 = false;
        var param$7;
        return InputFields.infraSelectInput(
          param,
          arg,
          param$1,
          param$2,
          param$3,
          arg$1,
          param$4,
          param$5,
          param$6,
          param$7,
        );
      };
    },
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    true,
    undefined,
    undefined,
    undefined,
  );
}

function getArrayOfPermissionData(json) {
  return LogicUtils.getArrayFromDict(
    LogicUtils.getDictFromJsonObject(json),
    "groups",
    [],
  ).map(function (i) {
    return Core__Option.getOr(Core__JSON.Decode.string(i), "");
  });
}

function updatePresentInInfoList(infoData, permissionsData) {
  var copyOfInfoData = infoData.slice();
  var copyOfPermissionsData = permissionsData.slice();
  return copyOfInfoData.map(function (infoValItem) {
    if (copyOfPermissionsData.includes(infoValItem.module_)) {
      infoValItem.isPermissionAllowed = true;
    } else {
      infoValItem.isPermissionAllowed = false;
    }
    return infoValItem;
  });
}

function defaultPresentInInfoList(infoData) {
  var copyOfInfoData = infoData.slice();
  return copyOfInfoData.map(function (infoValItem) {
    infoValItem.isPermissionAllowed = false;
    return infoValItem;
  });
}

function UserManagementUtils$RolePermissionValueRenderer(props) {
  var isPermissionAllowed = props.isPermissionAllowed;
  var isPermissionAllowed$1 =
    isPermissionAllowed !== undefined ? isPermissionAllowed : false;
  return React.createElement(
    "div",
    {
      className: "flex justify-between",
    },
    React.createElement(
      "div",
      {
        className: "flex flex-col gap-3 items-start col-span-1",
      },
      React.createElement(
        "div",
        {
          className: "font-semibold",
        },
        props.heading,
      ),
      React.createElement(
        "div",
        {
          className: "text-base text-hyperswitch_black opacity-50 flex-1",
        },
        props.description,
      ),
    ),
    React.createElement(Icon.make, {
      name: isPermissionAllowed$1 ? "permitted" : "not-permitted",
      size: 22,
    }),
  );
}

var RolePermissionValueRenderer = {
  make: UserManagementUtils$RolePermissionValueRenderer,
};

function roleListResponseMapper(dict) {
  return {
    role_id: LogicUtils.getString(dict, "role_id", ""),
    role_name: LogicUtils.getString(dict, "role_name", ""),
  };
}

function tabIndeToVariantMapper(index) {
  if (index !== 0) {
    return /* Roles */ 1;
  } else {
    return /* Users */ 0;
  }
}

var errorClass = "text-sm leading-4 font-medium text-start ml-1 mt-2";

export {
  errorClass,
  inviteEmail,
  createCustomRole,
  roleScope,
  validateEmptyValue,
  validateForm,
  validateFormForRoles,
  roleListDataMapper,
  roleOptions,
  roleType,
  getArrayOfPermissionData,
  updatePresentInInfoList,
  defaultPresentInInfoList,
  RolePermissionValueRenderer,
  roleListResponseMapper,
  tabIndeToVariantMapper,
};
/* inviteEmail Not a pure module */
