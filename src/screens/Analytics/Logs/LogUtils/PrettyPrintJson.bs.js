// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Icon from "../../../../components/Icon.bs.js";
import * as Curry from "rescript/lib/es6/curry.js";
import * as React from "react";
import * as Button from "../../../../components/Button.bs.js";
import * as UIUtils from "../../../../utils/UIUtils.bs.js";
import * as Clipboard from "../../../../libraries/Clipboard.bs.js";
import * as LogicUtils from "../../../../utils/LogicUtils.bs.js";
import * as ToastState from "../../../../hooks/ToastState.bs.js";
import * as Caml_option from "rescript/lib/es6/caml_option.js";
import * as Core__Option from "@rescript/core/src/Core__Option.bs.js";
import * as ReactSyntaxHighlighter from "../../../../libraries/ReactSyntaxHighlighter.bs.js";
import * as Hljs from "react-syntax-highlighter/dist/esm/styles/hljs";

function PrettyPrintJson(props) {
  var maxHeightClass = props.maxHeightClass;
  var headerText = props.headerText;
  var jsonToDisplay = props.jsonToDisplay;
  var headerText$1 =
    headerText !== undefined
      ? Caml_option.valFromOption(headerText)
      : undefined;
  var maxHeightClass$1 =
    maxHeightClass !== undefined ? maxHeightClass : "max-h-25-rem";
  var showToast = ToastState.useShowToast(undefined);
  var match = React.useState(function () {
    return false;
  });
  var setIsTextVisible = match[1];
  var isTextVisible = match[0];
  var match$1 = React.useState(function () {
    return "";
  });
  var setParsedJson = match$1[1];
  var parsedJson = match$1[0];
  var parseJsonValue = function (param) {
    try {
      var parsedValue = JSON.stringify(JSON.parse(jsonToDisplay), null, 3);
      return Curry._1(setParsedJson, function (param) {
        return parsedValue;
      });
    } catch (exn) {
      return Curry._1(setParsedJson, function (param) {
        return jsonToDisplay;
      });
    }
  };
  React.useEffect(
    function () {
      parseJsonValue(undefined);
    },
    [jsonToDisplay],
  );
  var copyParsedJson = React.createElement(
    "div",
    {
      className: "cursor-pointer",
      onClick: function (param) {
        Clipboard.writeText(parsedJson);
        Curry._8(
          showToast,
          "Copied to Clipboard!",
          /* ToastSuccess */ 3,
          undefined,
          undefined,
          undefined,
          undefined,
          undefined,
          undefined,
        );
      },
    },
    React.createElement(Icon.make, {
      name: "copy-code",
    }),
  );
  return React.createElement(
    "div",
    {
      className: "flex flex-col gap-2",
    },
    React.createElement(UIUtils.RenderIf.make, {
      condition: LogicUtils.isNonEmptyString(parsedJson),
      children: React.createElement(
        React.Fragment,
        undefined,
        React.createElement(UIUtils.RenderIf.make, {
          condition: Core__Option.isSome(headerText$1),
          children: React.createElement(
            "div",
            {
              className: "flex justify-between items-center",
            },
            React.createElement(
              "p",
              {
                className:
                  "font-bold text-fs-16 text-jp-gray-900 text-opacity-75",
              },
              Core__Option.getOr(headerText$1, ""),
            ),
            copyParsedJson,
          ),
        }),
        React.createElement(
          "div",
          {
            className: isTextVisible
              ? "overflow-visible "
              : "overflow-clip  h-fit " + maxHeightClass$1 + "",
          },
          React.createElement(ReactSyntaxHighlighter.SyntaxHighlighter.make, {
            language: "json",
            style: Caml_option.some(Hljs.googlecode),
            customStyle: {
              backgroundColor: "transparent",
              lineHeight: "1.7rem",
              fontSize: "0.875rem",
              padding: "5px",
            },
            showLineNumbers: true,
            lineNumberContainerStyle: {
              backgroundColor: "red",
              paddingLeft: "0px",
              padding: "100px",
            },
            children: parsedJson,
          }),
        ),
        React.createElement(Button.make, {
          text: isTextVisible ? "Hide" : "See more",
          onClick: function (param) {
            Curry._1(setIsTextVisible, function (param) {
              return !isTextVisible;
            });
          },
          customButtonStyle: "h-6 w-8 flex flex-1 justify-center m-1",
        }),
      ),
    }),
    React.createElement(UIUtils.RenderIf.make, {
      condition: LogicUtils.isEmptyString(parsedJson),
      children: React.createElement(
        "div",
        {
          className: "flex flex-col justify-start items-start gap-2 h-25-rem",
        },
        React.createElement(
          "p",
          {
            className: "font-bold text-fs-16 text-jp-gray-900 text-opacity-75",
          },
          Core__Option.getOr(headerText$1, ""),
        ),
        React.createElement(
          "p",
          {
            className:
              "font-normal text-fs-14 text-jp-gray-900 text-opacity-50",
          },
          "Failed to load!",
        ),
      ),
    }),
  );
}

var make = PrettyPrintJson;

export { make };
/* Icon Not a pure module */
