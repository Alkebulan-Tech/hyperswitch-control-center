// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Curry from "rescript/lib/es6/curry.js";
import * as Js_exn from "rescript/lib/es6/js_exn.js";
import * as Recoil from "recoil";
import * as APIUtils from "../APIUtils/APIUtils.bs.js";
import * as HomeUtils from "../Home/HomeUtils.bs.js";
import * as LogicUtils from "../../utils/LogicUtils.bs.js";
import * as Core__Option from "@rescript/core/src/Core__Option.bs.js";
import * as DictionaryUtils from "../../utils/DictionaryUtils.bs.js";
import * as HyperswitchAtom from "../../Recoils/HyperswitchAtom.bs.js";
import * as QuickStartUtils from "../Home/QuickStart/QuickStartUtils.bs.js";
import * as Caml_js_exceptions from "rescript/lib/es6/caml_js_exceptions.js";

function useFetchEnumDetails(param) {
  var fetchDetails = APIUtils.useGetMethod(undefined, undefined);
  var setEnumVariantValues = Recoil.useSetRecoilState(
    HyperswitchAtom.enumVariantAtom,
  );
  return async function (enumArray) {
    try {
      var url =
        "" +
        APIUtils.getURL(
          /* USERS */ 22,
          /* Get */ 0,
          undefined,
          undefined,
          "USER_DATA",
          undefined,
          undefined,
          undefined,
          undefined,
        ) +
        "?keys=" +
        enumArray.join(",") +
        "";
      var res = await Curry._1(fetchDetails, url);
      var responseDict = HomeUtils.responseDataMapper(
        res,
        HomeUtils.getValueMapped,
      );
      setEnumVariantValues(function (param) {
        return JSON.stringify(responseDict);
      });
      return responseDict;
    } catch (raw_e) {
      var e = Caml_js_exceptions.internalToOCamlException(raw_e);
      if (e.RE_EXN_ID === Js_exn.$$Error) {
        return Js_exn.raiseError(
          Core__Option.getOr(e._1.message, "Failed to Fetch!"),
        );
      }
      throw e;
    }
  };
}

function useUpdateEnumInRecoil(param) {
  var match = Recoil.useRecoilState(HyperswitchAtom.enumVariantAtom);
  var setEnumVariantValues = match[1];
  var enumVariantValues = match[0];
  return function (enumVariantsAndBodies) {
    var enumValueDict = LogicUtils.getDictFromJsonObject(
      LogicUtils.safeParse(enumVariantValues),
    );
    var enumDictsArray = [enumValueDict];
    enumVariantsAndBodies.forEach(function (item) {
      var enumVariant = item[1];
      var body = item[0];
      var bodyValForApi = QuickStartUtils.generateBodyBasedOnType(
        enumVariant,
        body,
      );
      switch (body.TAG | 0) {
        case /* Boolean */ 4:
          var booleanDict = Object.fromEntries([[enumVariant, true]]);
          enumDictsArray.push(booleanDict);
          return;
        case /* String */ 5:
          var stringDict = Object.fromEntries([[enumVariant, body._0]]);
          enumDictsArray.push(stringDict);
          return;
        default:
          enumDictsArray.push(LogicUtils.getDictFromJsonObject(bodyValForApi));
          return;
      }
    });
    var updatedRecoilValueDict = DictionaryUtils.mergeDicts(enumDictsArray);
    setEnumVariantValues(function (param) {
      return JSON.stringify(updatedRecoilValueDict);
    });
    return updatedRecoilValueDict;
  };
}

function usePostEnumDetails(param) {
  var updateDetails = APIUtils.useUpdateMethod(undefined, undefined);
  var updateEnumInRecoil = useUpdateEnumInRecoil(undefined);
  return async function (body, enumVariant) {
    try {
      var url = APIUtils.getURL(
        /* USERS */ 22,
        /* Post */ 2,
        undefined,
        undefined,
        "MERCHANT_DATA",
        undefined,
        undefined,
        undefined,
        undefined,
      );
      var bodyValForApi = QuickStartUtils.generateBodyBasedOnType(
        enumVariant,
        body,
      );
      await Curry._7(
        updateDetails,
        url,
        bodyValForApi,
        /* Post */ 2,
        undefined,
        undefined,
        undefined,
        undefined,
      );
      return Curry._1(updateEnumInRecoil, [[body, enumVariant]]);
    } catch (raw_e) {
      var e = Caml_js_exceptions.internalToOCamlException(raw_e);
      if (e.RE_EXN_ID === Js_exn.$$Error) {
        return Js_exn.raiseError(
          Core__Option.getOr(e._1.message, "Failed to Fetch!"),
        );
      }
      throw e;
    }
  };
}

export { useFetchEnumDetails, useUpdateEnumInRecoil, usePostEnumDetails };
/* recoil Not a pure module */
