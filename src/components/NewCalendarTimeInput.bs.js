// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Curry from "rescript/lib/es6/curry.js";
import Dayjs from "dayjs";
import * as React from "react";
import * as Core__JSON from "@rescript/core/src/Core__JSON.bs.js";
import * as LogicUtils from "../utils/LogicUtils.bs.js";
import * as Core__Option from "@rescript/core/src/Core__Option.bs.js";
import * as ConfigContext from "../context/ConfigContext.bs.js";
import * as DateTimeUtils from "../utils/DateTimeUtils.bs.js";
import * as HeadlessUISelectBox from "./HeadlessUISelectBox.bs.js";

var textBoxClass =
  " font-inter-style text-fs-14 leading-5 font-normal text-jp-2-light-gray-2000";

function NewCalendarTimeInput$CustomInputBox(props) {
  var maxLength = props.maxLength;
  var borderClass = props.borderClass;
  var fontClassName = props.fontClassName;
  var widthClass = props.widthClass;
  var autoFocus = props.autoFocus;
  var inputMode = props.inputMode;
  var type_ = props.type_;
  var isDisabled = props.isDisabled;
  var input = props.input;
  var isDisabled$1 = isDisabled !== undefined ? isDisabled : false;
  var type_$1 = type_ !== undefined ? type_ : "text";
  var inputMode$1 = inputMode !== undefined ? inputMode : "text";
  var autoFocus$1 = autoFocus !== undefined ? autoFocus : false;
  var widthClass$1 = widthClass !== undefined ? widthClass : "w-full";
  var fontClassName$1 =
    fontClassName !== undefined
      ? fontClassName
      : "text-jp-gray-900 text-body text-opacity-75";
  var borderClass$1 =
    borderClass !== undefined
      ? borderClass
      : "h-10 pl-4 border-2 border-jp-gray-700 dark:border-jp-gray-800 border-opacity-25 focus:border-opacity-100 focus:border-blue-500 dark:focus:border-blue-500 rounded-md";
  var maxLength$1 = maxLength !== undefined ? maxLength : 100;
  var cursorClass = isDisabled$1
    ? "cursor-not-allowed bg-jp-gray-400 dark:bg-jp-gray-950"
    : "bg-transparent";
  var placeholder = isDisabled$1
    ? "To be filled by customer"
    : props.placeholder;
  var className =
    "" +
    widthClass$1 +
    " " +
    cursorClass +
    "\n        placeholder-jp-gray-900 placeholder-opacity-50 dark:placeholder-jp-gray-700 dark:placeholder-opacity-50\n         " +
    borderClass$1 +
    "\n        focus:text-opacity-100 focus:outline-none dark:text-jp-gray-text_darktheme dark:text-opacity-75 dark:focus:text-opacity-100  " +
    fontClassName$1 +
    "";
  var str = Core__JSON.Decode.string(input.value);
  var value = str !== undefined ? str : "";
  return React.createElement(HeadlessUISelectBox.make, {
    value: {
      TAG: /* String */ 0,
      _0: "",
    },
    setValue: props.setVal,
    options: DateTimeUtils.timeOptions.map(function (str) {
      return {
        label: str,
        value: str,
        isDisabled: false,
        leftIcon: /* NoIcon */ 0,
        customTextStyle: undefined,
        customIconStyle: undefined,
        rightIcon: /* NoIcon */ 0,
        description: undefined,
      };
    }),
    children: React.createElement("input", {
      className: className,
      autoFocus: autoFocus$1,
      disabled: isDisabled$1,
      inputMode: inputMode$1,
      maxLength: maxLength$1,
      name: input.name,
      placeholder: placeholder,
      type: type_$1,
      value: value,
      onFocus: input.onFocus,
      onBlur: input.onBlur,
      onChange: input.onChange,
    }),
    dropdownPosition: /* Right */ 1,
    className: "",
    dropDownClass:
      "w-[216px] h-[296px] overflow-scroll !rounded-lg !shadow-jp-2-xs",
    textClass: textBoxClass,
    closeListOnClick: true,
  });
}

var CustomInputBox = {
  make: NewCalendarTimeInput$CustomInputBox,
};

function NewCalendarTimeInput(props) {
  var startTimeStr = props.startTimeStr;
  var setEndDate = props.setEndDate;
  var setStartDate = props.setStartDate;
  var isoStringToCustomTimeZone = props.isoStringToCustomTimeZone;
  var getTimeStringForValue = props.getTimeStringForValue;
  var localEndDate = props.localEndDate;
  var todayTime = props.todayTime;
  var todayDate = props.todayDate;
  var disableFutureDates = props.disableFutureDates;
  var localStartDate = props.localStartDate;
  var endDate = props.endDate;
  var startDate = props.startDate;
  var match = React.useContext(ConfigContext.configContext);
  var borderColor = match.globalUIConfig.border.borderColor;
  var todayDateTime = Dayjs();
  var time = todayDateTime.format("hh:mm:ss a");
  var defaultStartTime =
    endDate === todayDateTime.format("YYYY-MM-DD")
      ? time.toUpperCase()
      : Dayjs("" + endDate + " " + props.endTimeStr + "")
          .format("hh:mm:ss a")
          .toUpperCase();
  var match$1 = React.useState(function () {
    return Dayjs("" + startDate + " " + startTimeStr + "")
      .format("hh:mm:ss a")
      .toUpperCase();
  });
  var setFromTime = match$1[1];
  var fromTime = match$1[0];
  var match$2 = React.useState(function () {
    return defaultStartTime;
  });
  var settoTime = match$2[1];
  var toTime = match$2[0];
  var fromDateJs = Dayjs(startDate);
  var toDateJs = Dayjs(endDate);
  var inputFromDate_onBlur = function (param) {};
  var inputFromDate_onChange = function (ev) {
    var value = ev.target.value;
    Curry._1(setFromTime, function (param) {
      return value;
    });
  };
  var inputFromDate_onFocus = function (param) {};
  var inputFromDate = {
    name: "fromDate",
    onBlur: inputFromDate_onBlur,
    onChange: inputFromDate_onChange,
    onFocus: inputFromDate_onFocus,
    value: fromTime,
    checked: true,
  };
  var inputtoDate_onBlur = function (param) {};
  var inputtoDate_onChange = function (ev) {
    var value = ev.target.value;
    Curry._1(settoTime, function (param) {
      return value;
    });
  };
  var inputtoDate_onFocus = function (param) {};
  var inputtoDate = {
    name: "toDate",
    onBlur: inputtoDate_onBlur,
    onChange: inputtoDate_onChange,
    onFocus: inputtoDate_onFocus,
    value: toTime,
    checked: true,
  };
  var setFromTimeDropdown = function (val) {
    var fromTimeArr = val.split(" ");
    var fromTime =
      "" +
      Core__Option.getOr(fromTimeArr[0], "12:00") +
      ":00 " +
      Core__Option.getOr(fromTimeArr[1], "AM") +
      "";
    Curry._1(setFromTime, function (param) {
      return fromTime.toUpperCase();
    });
  };
  var setToTimeDropdown = function (val) {
    var toTimeArr = val.split(" ");
    var toTime =
      "" +
      Core__Option.getOr(toTimeArr[0], "11:59") +
      ":00 " +
      Core__Option.getOr(toTimeArr[1], "PM") +
      "";
    Curry._1(settoTime, function (param) {
      return toTime.toUpperCase();
    });
  };
  React.useEffect(
    function () {
      var endTime = Curry._2(
        getTimeStringForValue,
        localEndDate,
        isoStringToCustomTimeZone,
      );
      var startDateTime = Dayjs("" + startDate + " " + fromTime + "");
      if (startDateTime.isValid()) {
        var startTimeVal = startDateTime.format("HH:mm:ss");
        if (LogicUtils.isNonEmptyString(localStartDate)) {
          if (
            disableFutureDates &&
            startDate === todayDate &&
            startTimeVal > todayTime
          ) {
            Curry._2(setStartDate, startDate, todayTime);
          } else if (
            disableFutureDates &&
            startDate === endDate &&
            startTimeVal > endTime
          ) {
          } else {
            Curry._2(setStartDate, startDate, startTimeVal);
          }
        }
      }
    },
    [fromTime],
  );
  React.useEffect(
    function () {
      var startTime = Curry._2(
        getTimeStringForValue,
        localStartDate,
        isoStringToCustomTimeZone,
      );
      var endDateTime = Dayjs("" + endDate + " " + toTime + "");
      if (endDateTime.isValid()) {
        var endTimeVal = endDateTime.format("HH:mm:ss");
        if (LogicUtils.isNonEmptyString(localEndDate)) {
          if (
            disableFutureDates &&
            endDate === todayDate &&
            endTimeVal > todayTime
          ) {
            Curry._2(setEndDate, startDate, todayTime);
          } else if (
            disableFutureDates &&
            startDate === endDate &&
            endTimeVal < startTime
          ) {
          } else {
            Curry._2(setEndDate, endDate, endTimeVal);
          }
        }
      }
    },
    [toTime],
  );
  var updatedFromDate;
  if (fromDateJs.isValid()) {
    try {
      updatedFromDate = fromDateJs.format("dddd, MMMM DD, YYYY");
    } catch (_error) {
      updatedFromDate = "";
    }
  } else {
    updatedFromDate = "";
  }
  var updatedToDate;
  if (toDateJs.isValid()) {
    try {
      updatedToDate = toDateJs.format("dddd, MMMM DD, YYYY");
    } catch (_error$1) {
      updatedToDate = "";
    }
  } else {
    updatedToDate = "";
  }
  var dateClass =
    "text-jp-2-light-gray-1200 text-fs-16 font-normal leading-6 mb-4";
  return React.createElement(
    "div",
    {
      className: "w-[328px] px-6 font-inter-style mb-12 pt-4 ",
    },
    React.createElement(
      "div",
      {
        className: "mb-10",
      },
      React.createElement(
        "div",
        {
          className: dateClass,
        },
        updatedFromDate,
      ),
      React.createElement(
        "div",
        {
          className: "w-4/12",
        },
        React.createElement(NewCalendarTimeInput$CustomInputBox, {
          input: inputFromDate,
          placeholder: "09:00 AM",
          fontClassName: textBoxClass,
          borderClass:
            "h-10 pl-1 border-b border-jp-gray-lightmode_steelgray dark:border-jp-gray-700 border-opacity-75 focus:border-opacity-100 " +
            borderColor.primaryFocused +
            " dark:" +
            borderColor.primaryFocused +
            "",
          setVal: setFromTimeDropdown,
        }),
      ),
    ),
    React.createElement(
      "div",
      undefined,
      React.createElement(
        "div",
        {
          className: dateClass,
        },
        updatedToDate,
      ),
      React.createElement(
        "div",
        {
          className: "w-4/12",
        },
        React.createElement(NewCalendarTimeInput$CustomInputBox, {
          input: inputtoDate,
          placeholder: "11:00 PM",
          fontClassName: textBoxClass,
          borderClass:
            "h-10 pl-1 border-b border-jp-gray-lightmode_steelgray dark:border-jp-gray-700 border-opacity-75 focus:border-opacity-100 " +
            borderColor.primaryFocused +
            " dark:" +
            borderColor.primaryFocused +
            "",
          setVal: setToTimeDropdown,
        }),
      ),
    ),
  );
}

var make = NewCalendarTimeInput;

export { textBoxClass, CustomInputBox, make };
/* dayjs Not a pure module */
